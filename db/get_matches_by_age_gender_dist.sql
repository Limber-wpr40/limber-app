Select limber_user.*, Extract(Year from age(limber_user.birth_date)) AS current_age, Round(sqrt(power(Round(limber_user.latitude - user_1.latitude, 1)*69,2) + power(Round(limber_user.longitude - user_1.longitude, 1)*53,2)),0) AS dist from limber_user, limber_user as user_1 where user_1.user_id = $1 AND Extract(Year from age( limber_user.birth_date))>= $2 AND Extract(Year from age( Limber_user.birth_date)) <= $3 AND limber_user.gender <> $4;